<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Skabt til fremtiden ‚Äì Et interaktivt univers om h√•b, handling og at turde kigge ud under dynen.">
    <title>Skabt til fremtiden</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,700;1,9..40,400&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'deep-night': '#0D0D0D',
                        'warm-cream': '#F5F0E8',
                        'stone-gray': '#6B6B6B',
                        'soft-white': '#FAFAFA',
                        'vivid-green': '#00D26A',
                        'deep-forest': '#1A3D2E',
                        'sun-glow': '#FFD93D',
                    },
                    fontFamily: {
                        'display': ['"Instrument Serif"', 'Georgia', 'serif'],
                        'body': ['"DM Sans"', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style>
        :root {
            --deep-night: #0D0D0D;
            --warm-cream: #F5F0E8;
            --stone-gray: #6B6B6B;
            --soft-white: #FAFAFA;
            --vivid-green: #00D26A;
            --deep-forest: #1A3D2E;
            --sun-glow: #FFD93D;
        }
        
        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'DM Sans', system-ui, sans-serif;
            background-color: var(--deep-night);
            color: var(--warm-cream);
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        .font-display { font-family: 'Instrument Serif', Georgia, serif; }
        
        @keyframes fade-up { 
            0% { opacity: 0; transform: translateY(30px); } 
            100% { opacity: 1; transform: translateY(0); } 
        }
        @keyframes pulse-soft { 
            0%, 100% { opacity: 0.6; transform: translateY(0); } 
            50% { opacity: 1; transform: translateY(8px); } 
        }
        @keyframes plant-grow { 
            0% { opacity: 0; transform: scaleY(0) translateY(30px); } 
            100% { opacity: 1; transform: scaleY(1) translateY(0); } 
        }
        @keyframes leaf-sway { 
            0%, 100% { transform: rotateZ(-2deg); } 
            50% { transform: rotateZ(2deg); } 
        }
        
        .hero-text-1 { animation: fade-up 0.8s ease-out 1s forwards; opacity: 0; }
        .hero-text-2 { animation: fade-up 0.8s ease-out 1.2s forwards; opacity: 0; }
        .hero-text-3 { animation: fade-up 0.8s ease-out 1.4s forwards; opacity: 0; }
        .scroll-indicator { animation: pulse-soft 2s ease-in-out infinite; }
        
        .reveal { 
            opacity: 0; 
            transform: translateY(40px); 
            transition: opacity 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .reveal.visible { 
            opacity: 1; 
            transform: translateY(0); 
        }
        
        .reveal-delay-1 { transition-delay: 0.1s; }
        .reveal-delay-2 { transition-delay: 0.2s; }
        .reveal-delay-3 { transition-delay: 0.3s; }
        .reveal-delay-4 { transition-delay: 0.4s; }
        
        .btn-hope { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .btn-hope:hover { transform: scale(1.05); box-shadow: 0 10px 30px rgba(0, 210, 106, 0.3); }
        
        .login-modal { display: none; position: fixed; inset: 0; background-color: rgba(13, 13, 13, 0.95); z-index: 2000; align-items: center; justify-content: center; padding: 1rem; }
        .login-modal.active { display: flex; }
        
        .admin-login-modal { display: none; position: fixed; inset: 0; background-color: rgba(13, 13, 13, 0.95); z-index: 2000; align-items: center; justify-content: center; padding: 1rem; }
        .admin-login-modal.active { display: flex; }
        
        .admin-dashboard { display: none; position: fixed; inset: 0; background-color: var(--deep-night); z-index: 1500; overflow-y: auto; padding-top: 5rem; }
        .admin-dashboard.active { display: block; }
        
        .quiz-container { display: none; }
        .quiz-container.active { display: block; }
        
        .answer-review-item {
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .answer-review-item.correct {
            border-left-color: var(--vivid-green);
            background: linear-gradient(90deg, rgba(0, 210, 106, 0.1) 0%, transparent 100%);
        }
        
        .answer-review-item.incorrect {
            border-left-color: #EF4444;
            background: linear-gradient(90deg, rgba(239, 68, 68, 0.1) 0%, transparent 100%);
        }
        
        .lightbox-modal { display: none; position: fixed; inset: 0; background-color: rgba(13, 13, 13, 0.95); z-index: 1000; align-items: center; justify-content: center; padding: 1rem; }
        .lightbox-modal.active { display: flex; }
        
        .lightbox-content { position: relative; max-width: 90vw; max-height: 90vh; }
        .lightbox-close { position: absolute; top: -40px; right: 0; color: white; cursor: pointer; font-size: 2rem; background: none; border: none; padding: 0.5rem; }
        
        .organic-shape { 
            position: absolute; 
            border-radius: 50% 40% 60% 50%; 
            opacity: 0.1; 
            filter: blur(60px); 
            pointer-events: none; 
        }
        
        .plant-container {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 3;
            overflow: hidden;
        }
        
        .plant {
            position: absolute;
            font-size: 2rem;
            opacity: 0;
            filter: drop-shadow(0 0 10px rgba(0, 210, 106, 0.4));
        }
        
        .plant.grow { animation: plant-grow 1.2s ease-out forwards; }
        .plant.sway { animation: leaf-sway 3s ease-in-out infinite; }
        
        .idea-card {
            position: relative;
            overflow: hidden;
            border-radius: 1.5rem;
            background: linear-gradient(135deg, rgba(0, 210, 106, 0.1) 0%, rgba(26, 61, 46, 0.1) 100%);
            border: 2px solid rgba(0, 210, 106, 0.2);
            padding: 2rem;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: all 0.4s ease;
        }
        
        .idea-card:hover {
            border-color: var(--vivid-green);
            box-shadow: 0 10px 30px rgba(0, 210, 106, 0.2);
            transform: translateY(-4px);
        }
        
        .idea-card-content {
            position: relative;
            z-index: 1;
        }
        
        .idea-number {
            font-size: 3rem;
            font-weight: bold;
            color: var(--vivid-green);
            opacity: 0.3;
            margin-bottom: 1rem;
        }
        
        .idea-title {
            font-family: 'Instrument Serif', Georgia, serif;
            font-size: 1.5rem;
            color: var(--warm-cream);
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .idea-text {
            font-family: 'DM Sans', system-ui, sans-serif;
            font-size: 0.95rem;
            color: rgba(245, 240, 232, 0.8);
            line-height: 1.6;
        }
        
        .author-card {
            background: linear-gradient(135deg, rgba(0, 210, 106, 0.1) 0%, rgba(26, 61, 46, 0.1) 100%);
            border: 2px solid rgba(0, 210, 106, 0.2);
            border-radius: 1.5rem;
            padding: 2rem;
            transition: all 0.4s ease;
        }
        
        .author-card:hover {
            border-color: var(--vivid-green);
            box-shadow: 0 10px 30px rgba(0, 210, 106, 0.2);
            transform: translateY(-4px);
        }
        
        .author-title {
            font-family: 'Instrument Serif', Georgia, serif;
            font-size: 1.3rem;
            color: var(--vivid-green);
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .author-text {
            font-size: 0.95rem;
            color: rgba(245, 240, 232, 0.8);
            line-height: 1.6;
        }
        
        .exercise-card { transition: transform 0.4s ease, border-color 0.3s ease; }
        .exercise-card:hover { transform: translateY(-4px); border-color: var(--vivid-green); }
        
        .song-suggestion-form { background: linear-gradient(135deg, rgba(0, 210, 106, 0.1) 0%, rgba(255, 217, 61, 0.05) 100%); }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--deep-night); }
        ::-webkit-scrollbar-thumb { background: var(--deep-forest); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--vivid-green); }
    </style>
</head>
<body>
    <!-- PLANT CONTAINER FOR GROWING ANIMATIONS -->
    <div class="plant-container" id="plant-container"></div>
    
    <!-- LOGIN MODAL -->
    <div id="login-modal" class="login-modal active">
        <div class="bg-soft-white rounded-3xl p-8 sm:p-10 shadow-2xl max-w-md w-full">
            <div class="text-center mb-8">
                <h1 class="font-display text-4xl text-deep-night mb-2">Skabt til fremtiden</h1>
                <p class="font-body text-stone-gray">Performance 2026</p>
            </div>
            <form id="login-form">
                <div class="mb-6">
                    <label for="login-code" class="block font-body text-sm text-deep-night/70 mb-2">Kodeord</label>
                    <input type="password" id="login-code" class="w-full px-4 py-3 border-2 border-stone-gray/20 rounded-lg font-body text-deep-night focus:outline-none focus:border-vivid-green" placeholder="Skriv kodeordet her..." required>
                </div>
                <label class="flex items-center gap-3 mb-6 cursor-pointer">
                    <input type="checkbox" id="remember-me" class="w-5 h-5">
                    <span class="font-body text-sm text-deep-night/70">Husk mig</span>
                </label>
                <button type="submit" class="btn-hope w-full py-3 bg-vivid-green text-deep-night font-body font-medium rounded-lg">Kom ind</button>
            </form>
        </div>
    </div>

    <!-- ADMIN LOGIN MODAL -->
    <div id="admin-login-modal" class="admin-login-modal">
        <div class="bg-soft-white rounded-3xl p-8 sm:p-10 shadow-2xl max-w-md w-full">
            <div class="text-center mb-8">
                <h1 class="font-display text-3xl text-deep-night mb-2">Admin Panel</h1>
                <p class="font-body text-stone-gray text-sm">L√¶rer adgang</p>
            </div>
            <form id="admin-login-form">
                <div class="mb-6">
                    <label for="admin-code" class="block font-body text-sm text-deep-night/70 mb-2">Admin Kode</label>
                    <input type="password" id="admin-code" class="w-full px-4 py-3 border-2 border-stone-gray/20 rounded-lg font-body text-deep-night focus:outline-none focus:border-vivid-green" placeholder="Skriv admin koden her..." required>
                </div>
                <button type="submit" class="btn-hope w-full py-3 bg-vivid-green text-deep-night font-body font-medium rounded-lg">√Öbn Admin Panel</button>
            </form>
            <button onclick="closeAdminLogin()" class="w-full mt-4 py-3 border-2 border-stone-gray/20 text-deep-night font-body rounded-lg hover:border-deep-forest transition-colors">Tilbage</button>
        </div>
    </div>

    <!-- NAVIGATION -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-deep-night/80 backdrop-blur-md border-b border-white/5">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="#" class="flex items-center gap-3 hover:opacity-80 transition-opacity">
                    <span class="font-display text-xl text-warm-cream">Skabt til fremtiden</span>
                </a>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#verden" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors">Verden</a>
                    <a href="#litteratur" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors">Litteratur</a>
                    <a href="#quiz" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors">Quiz</a>
                    <a href="#√∏velser" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors">√òvelser</a>
                    <a href="#musik" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors">Musik</a>
                    <a href="#brevkasse" class="font-body text-sm px-4 py-2 bg-vivid-green text-deep-night rounded-full hover:bg-sun-glow transition-colors">Brevkasse</a>
                    <button id="admin-btn" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors" onclick="openAdminLogin()">Admin</button>
                    <button id="logout-btn" class="font-body text-sm text-stone-gray hover:text-warm-cream transition-colors" onclick="logout()">Log ud</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ADMIN DASHBOARD -->
    <div id="admin-dashboard" class="admin-dashboard">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <button onclick="closeAdmin()" class="px-6 py-3 bg-vivid-green text-deep-night rounded-lg mb-8">Luk Admin</button>
            <h1 class="font-display text-4xl text-warm-cream mb-8">Admin Panel</h1>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-deep-forest/20 border border-deep-forest/30 rounded-2xl p-6">
                    <h2 class="font-display text-2xl text-warm-cream mb-4">Quiz Resultater</h2>
                    <div id="admin-quiz-stats" class="space-y-3 font-body text-stone-gray"><p>Indl√¶ser...</p></div>
                </div>
                <div class="bg-deep-forest/20 border border-deep-forest/30 rounded-2xl p-6">
                    <h2 class="font-display text-2xl text-warm-cream mb-4">Indsendelser</h2>
                    <div id="admin-submissions" class="space-y-3 font-body text-stone-gray"><p>Indl√¶ser...</p></div>
                </div>
            </div>
        </div>
    </div>

    <main id="main-content" class="pt-16">
        <!-- HERO + OTHER SECTIONS - Keeping content intact, only showing quiz section below -->
        
        <!-- QUIZ SECTION -->
        <section id="quiz" class="relative py-24 sm:py-32 bg-warm-cream">
            <div class="organic-shape w-[400px] h-[400px] bg-vivid-green -left-32 top-1/2"></div>
            <div class="organic-shape w-[350px] h-[350px] bg-deep-forest -right-24 bottom-0"></div>
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                <div id="quiz-start" class="text-center reveal">
                    <span class="font-body text-sm font-medium text-deep-forest uppercase tracking-wider">Interaktiv</span>
                    <h2 class="font-display text-4xl sm:text-5xl text-deep-night mt-4 mb-6">Hvad ved du om verden?</h2>
                    <p class="font-body text-lg text-deep-night/70 max-w-2xl mx-auto mb-8">Baseret p√• Hans Roslings "Factfulness". Test din viden.</p>
                    <form id="quiz-name-form" class="max-w-md mx-auto mb-8">
                        <div class="mb-6"><input type="text" id="student-name-input" placeholder="Dit navn (eller anonymt)" class="w-full px-6 py-3 border-2 border-deep-forest/20 rounded-lg font-body text-deep-night placeholder-stone-gray focus:outline-none focus:border-vivid-green"></div>
                        <button type="submit" class="btn-hope w-full py-4 bg-vivid-green text-deep-night font-body font-medium rounded-lg">Start Quiz</button>
                    </form>
                </div>
                <div id="quiz-container" class="quiz-container">
                    <div class="bg-soft-white rounded-3xl p-8 sm:p-10 shadow-xl">
                        <div class="mb-8">
                            <div class="flex justify-between items-center mb-4">
                                <span class="font-body text-sm text-stone-gray">Sp√∏rgsm√•l <span id="current-question">1</span> af 10</span>
                                <div class="w-full mx-4 bg-stone-gray/20 rounded-full h-2"><div id="progress-bar" class="bg-vivid-green h-2 rounded-full" style="width: 10%"></div></div>
                            </div>
                        </div>
                        <h3 id="question-text" class="font-display text-2xl text-deep-night mb-8"></h3>
                        <div id="options-container" class="space-y-4 mb-8"></div>
                        <div class="flex gap-4">
                            <button id="prev-btn" class="flex-1 py-3 border-2 border-stone-gray/20 text-deep-night font-body rounded-lg hover:border-deep-forest transition-colors" onclick="previousQuestion()">Forrige</button>
                            <button id="next-btn" class="flex-1 py-3 bg-vivid-green text-deep-night font-body font-medium rounded-lg hover:bg-deep-forest transition-colors" onclick="nextQuestion()">N√¶ste</button>
                        </div>
                    </div>
                </div>
                <div id="quiz-results" class="quiz-container" style="display: none;">
                    <div class="bg-soft-white rounded-3xl p-8 sm:p-10 shadow-xl">
                        <div class="text-center mb-12">
                            <h3 class="font-display text-4xl text-deep-night mb-4">Dine resultater</h3>
                            <div class="grid md:grid-cols-3 gap-6 my-12">
                                <div class="p-6 bg-deep-forest/5 rounded-2xl"><p class="font-body text-stone-gray mb-2">Rigtige svar</p><p class="font-display text-4xl text-vivid-green" id="score-display">0/10</p></div>
                                <div class="p-6 bg-deep-forest/5 rounded-2xl"><p class="font-body text-stone-gray mb-2">Forkerte svar</p><p class="font-display text-4xl text-red-500" id="wrong-display">0</p></div>
                                <div class="p-6 bg-deep-forest/5 rounded-2xl"><p class="font-body text-stone-gray mb-2">Procent</p><p class="font-display text-4xl text-sun-glow" id="percentage-display">0%</p></div>
                            </div>
                        </div>
                        
                        <!-- ANSWER REVIEW SECTION -->
                        <div class="mb-12">
                            <h4 class="font-display text-2xl text-deep-night mb-6">Gennemgang af dine svar</h4>
                            <div id="answer-review-container" class="space-y-4"></div>
                        </div>
                        
                        <!-- SCOREBOARD SECTION -->
                        <div class="mb-12">
                            <h4 class="font-display text-2xl text-deep-night mb-6">Top 10 Scoreboard</h4>
                            <div id="scoreboard-container" class="bg-deep-night/5 rounded-2xl p-6">
                                <div id="scoreboard-list" class="space-y-3">
                                    <p class="font-body text-stone-gray text-center">Indl√¶ser scoreboard...</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-4">
                            <button onclick="resetQuiz()" class="btn-hope flex-1 py-4 px-8 bg-vivid-green text-deep-night font-body font-medium rounded-lg">Tag quizzen igen</button>
                            <button onclick="closeQuizAndScrollToTop()" class="btn-hope flex-1 py-4 px-8 border-2 border-deep-forest text-deep-night font-body font-medium rounded-lg hover:bg-deep-forest/5 transition-colors">Tilbage til toppen</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- FOOTER -->
    <footer class="bg-deep-night py-16 border-t border-white/5">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="font-display text-3xl text-warm-cream mb-2">Skabt til fremtiden</h2>
            <p class="font-body text-sun-glow text-sm mb-4">Performance 2026</p>
            <p class="font-body text-stone-gray max-w-lg mx-auto mb-8">Et projekt om h√•b, handling og at turde kigge ud under dynen.</p>
            <p class="font-body text-stone-gray/50 text-xs">Lindenborg Efterskole</p>
        </div>
    </footer>

    <script>
        // SUPABASE INITIALIZATION
        const SUPABASE_URL = 'https://zmfqodkasswmqohppcod.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InptZnFvZGthc3N3bXFvaHBwY29kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjU0NzQ4NTgsImV4cCI6MjA0MTA1MDg1OH0.o3R3x6vZL7H8D8W5K8h8fJ9K8h8fJ9K8h8';
        
        let supabase;
        try {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            console.log('‚úÖ Supabase initialized successfully');
        } catch (error) {
            console.error('‚ùå Supabase initialization error:', error);
        }

        const allQuizQuestions = [
            { q: "De seneste 20 √•r er andelen af mennesker i verden, der lever i ekstrem fattigdom...", a: ["N√¶sten fordoblet", "N√¶sten halveret", "Den samme som f√∏r", "Steget med 10%"], c: 1 },
            { q: "Hvor mange af verdens 1-√•rige b√∏rn har f√•et mindst √©n vaccination mod en sygdom?", a: ["20%", "50%", "80%", "95%"], c: 2 },
            { q: "Hvis vi kigger p√• √∏konomi, hvor bor st√∏rstedelen af verdens befolkning s√•?", a: ["I meget fattige lande", "I meget rige lande", "I midten (mellemindkomstlande)", "Vi ved det ikke"], c: 2 },
            { q: "Hvor mange piger g√∏r deres grundskole f√¶rdig i verdens fattigste lande?", a: ["20%", "40%", "60%", "80%"], c: 2 },
            { q: "Hvis du ser p√• verden generelt, hvad sker der s√• med udviklingen?", a: ["Det g√•r v√¶rre og v√¶rre", "De rige bliver rigere, og alle andre bliver fattigere", "Verden bliver faktisk bedre skridt for skridt", "Det st√•r helt stille"], c: 2 },
            { q: "Der er 2 milliarder b√∏rn i verden i dag. Hvor mange tror FN, der vil v√¶re i √•r 2100?", a: ["2 milliarder", "3 milliarder", "4 milliarder", "6 milliarder"], c: 0 },
            { q: "Hvad siger forskerne om temperaturen p√• jorden de n√¶ste 100 √•r?", a: ["Den vil falde", "Den vil stige", "Den forbliver den samme", "Det er umuligt at sige"], c: 1 },
            { q: "Verdens befolkning vokser stadig, men hvorfor kommer vi til at v√¶re flere mennesker i √•r 2100?", a: ["Fordi vi f√•r mange flere b√∏rn", "Fordi der bliver flere voksne (flere overlever barndommen)", "Fordi folk bliver 150 √•r gamle", "Fordi flere babyer bliver f√∏dt"], c: 1 },
            { q: "Hvordan klarer eksperter og folk med lange uddannelser sig i tests om verdens tilstand?", a: ["De har n√¶sten altid ret", "De g√¶tter bedre end tilf√¶ldigt", "De svarer ofte forkert og har et for√¶ldet verdensbillede", "De ved alt om fattigdom"], c: 2 },
            { q: "Hvor mange mennesker i verden har adgang til en eller anden form for elektricitet?", a: ["20%", "50%", "80%", "98%"], c: 2 }
        ];

        let currentQuiz = [], currentQuestionIndex = 0, selectedAnswers = {}, studentName = '';
        const LOGIN_CODE = 'egonolsen', ADMIN_CODE = 'Kaj', SESSION_KEY = 'fremtiden_session';

        function checkAuth() {
            if (!localStorage.getItem(SESSION_KEY)) {
                document.getElementById('login-modal').classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function logout() {
            localStorage.removeItem(SESSION_KEY);
            location.reload();
        }

        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            if (document.getElementById('login-code').value === LOGIN_CODE) {
                localStorage.setItem(SESSION_KEY, JSON.stringify({ timestamp: new Date().toISOString() }));
                document.getElementById('login-modal').classList.remove('active');
                document.body.style.overflow = '';
            } else {
                alert('Forkert kodeord');
            }
        });

        function openAdminLogin() { document.getElementById('admin-login-modal').classList.add('active'); }
        function closeAdminLogin() { document.getElementById('admin-login-modal').classList.remove('active'); }
        function closeAdmin() { document.getElementById('admin-dashboard').classList.remove('active'); }

        document.getElementById('admin-login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            if (document.getElementById('admin-code').value === ADMIN_CODE) {
                document.getElementById('admin-login-modal').classList.remove('active');
                document.getElementById('admin-dashboard').classList.add('active');
            } else {
                alert('Forkert admin kode');
            }
        });

        function shuffleArray(a) { for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
        function getRandomQuestions() { return shuffleArray([...allQuizQuestions]).slice(0, 10); }
        
        function startQuiz(name) {
            studentName = name || 'Anonym';
            currentQuiz = getRandomQuestions();
            currentQuestionIndex = 0;
            selectedAnswers = {};
            showQuestion();
            document.getElementById('quiz-start').classList.add('hidden');
            document.getElementById('quiz-container').classList.add('active');
        }

        function showQuestion() {
            const q = currentQuiz[currentQuestionIndex];
            document.getElementById('question-text').textContent = q.q;
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
            document.getElementById('progress-bar').style.width = ((currentQuestionIndex + 1) / 10 * 100) + '%';
            const c = document.getElementById('options-container');
            c.innerHTML = '';
            q.a.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'w-full p-4 text-left border-2 border-stone-gray/20 rounded-lg font-body text-deep-night hover:border-vivid-green transition-colors ' + (selectedAnswers[currentQuestionIndex] === idx ? 'bg-vivid-green/20 border-vivid-green' : 'bg-soft-white');
                btn.textContent = opt;
                btn.onclick = () => { selectedAnswers[currentQuestionIndex] = idx; showQuestion(); };
                c.appendChild(btn);
            });
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            document.getElementById('next-btn').textContent = currentQuestionIndex === 9 ? 'Se resultater' : 'N√¶ste';
        }

        function nextQuestion() { 
            if (currentQuestionIndex < 9) { 
                currentQuestionIndex++; 
                showQuestion(); 
            } else { 
                submitQuiz(); 
            } 
        }
        
        function previousQuestion() { 
            if (currentQuestionIndex > 0) { 
                currentQuestionIndex--; 
                showQuestion(); 
            } 
        }

        async function submitQuiz() {
            console.log('üìä submitQuiz called');
            let score = 0;
            Object.keys(selectedAnswers).forEach(idx => { if (selectedAnswers[idx] === currentQuiz[idx].c) score++; });
            const pct = (score / 10) * 100;
            
            console.log('üìà Score:', score, 'Percentage:', pct);
            
            // Display score stats
            document.getElementById('score-display').textContent = `${score}/10`;
            document.getElementById('wrong-display').textContent = `${10 - score}`;
            document.getElementById('percentage-display').textContent = `${pct.toFixed(0)}%`;
            
            // Display answer review
            displayAnswerReview(score);
            
            // Save to Supabase
            try {
                console.log('üíæ Attempting to save to Supabase...');
                const { data, error } = await supabase.from('quiz_results').insert([{
                    student_name: studentName,
                    score: score,
                    total_questions: 10,
                    percentage: pct
                }]);
                
                if (error) {
                    console.error('‚ùå Supabase insert error:', error);
                    console.error('Error details:', JSON.stringify(error, null, 2));
                } else {
                    console.log('‚úÖ Saved to Supabase successfully');
                }
            } catch (error) {
                console.error('‚ùå Supabase save exception:', error);
            }
            
            // Load and display scoreboard
            await loadScoreboard();
            
            // Hide quiz container and show results
            document.getElementById('quiz-container').classList.remove('active');
            document.getElementById('quiz-results').style.display = 'block';
            document.getElementById('quiz-results').classList.add('active');
            
            console.log('‚úÖ Results should now be visible');
        }

        function displayAnswerReview(score) {
            const container = document.getElementById('answer-review-container');
            container.innerHTML = '';
            
            currentQuiz.forEach((question, idx) => {
                const userAnswer = selectedAnswers[idx];
                const correctAnswer = question.c;
                const isCorrect = userAnswer === correctAnswer;
                
                const reviewItem = document.createElement('div');
                reviewItem.className = `answer-review-item ${isCorrect ? 'correct' : 'incorrect'} p-4 rounded-lg`;
                
                reviewItem.innerHTML = `
                    <div class="flex items-start gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full ${isCorrect ? 'bg-vivid-green' : 'bg-red-500'} flex items-center justify-center text-white font-bold">
                            ${isCorrect ? '‚úì' : '‚úó'}
                        </div>
                        <div class="flex-1">
                            <p class="font-body font-medium text-deep-night mb-2">${idx + 1}. ${question.q}</p>
                            <p class="font-body text-sm text-deep-night/70 mb-1">
                                <span class="font-medium">Dit svar:</span> ${question.a[userAnswer] || 'Ikke besvaret'}
                            </p>
                            ${!isCorrect ? `<p class="font-body text-sm text-vivid-green">
                                <span class="font-medium">Korrekt svar:</span> ${question.a[correctAnswer]}
                            </p>` : ''}
                        </div>
                    </div>
                `;
                
                container.appendChild(reviewItem);
            });
        }

        async function loadScoreboard() {
            const container = document.getElementById('scoreboard-list');
            container.innerHTML = '<p class="font-body text-stone-gray text-center">Indl√¶ser scoreboard...</p>';
            
            console.log('üèÜ Loading scoreboard...');
            
            try {
                const { data, error } = await supabase
                    .from('quiz_results')
                    .select('*')
                    .order('score', { ascending: false })
                    .order('created_at', { ascending: true })
                    .limit(10);
                
                if (error) {
                    console.error('‚ùå Scoreboard load error:', error);
                    console.error('Error details:', JSON.stringify(error, null, 2));
                    throw error;
                }
                
                console.log('üìä Scoreboard data:', data);
                
                if (data && data.length > 0) {
                    container.innerHTML = '';
                    data.forEach((result, index) => {
                        const item = document.createElement('div');
                        item.className = index === 0 ? 'bg-vivid-green/20 border-2 border-vivid-green p-4 rounded-lg flex justify-between items-center' : 'bg-deep-night/5 p-4 rounded-lg flex justify-between items-center';
                        item.innerHTML = `
                            <div class="flex items-center gap-3">
                                <span class="font-display text-2xl ${index < 3 ? 'text-sun-glow' : 'text-stone-gray'}">#${index + 1}</span>
                                <p class="font-body font-semibold text-deep-night">${result.student_name || 'Anonym'}</p>
                            </div>
                            <div class="text-right">
                                <p class="font-display text-lg ${index === 0 ? 'text-vivid-green' : 'text-deep-night'}">${result.score}/10</p>
                                <p class="font-body text-sm text-stone-gray">${result.percentage.toFixed(0)}%</p>
                            </div>
                        `;
                        container.appendChild(item);
                    });
                    console.log('‚úÖ Scoreboard rendered successfully');
                } else {
                    container.innerHTML = '<p class="font-body text-stone-gray text-center">Ingen resultater endnu</p>';
                    console.log('‚ÑπÔ∏è No scoreboard data yet');
                }
            } catch (error) {
                console.error('‚ùå Scoreboard exception:', error);
                container.innerHTML = '<p class="font-body text-red-500 text-center">Kunne ikke indl√¶se scoreboard</p>';
            }
        }

        function resetQuiz() {
            document.getElementById('quiz-start').classList.remove('hidden');
            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('quiz-results').classList.remove('active');
            document.getElementById('quiz-name-form').reset();
            selectedAnswers = {};
            currentQuestionIndex = 0;
            currentQuiz = [];
        }
        
        function closeQuizAndScrollToTop() {
            console.log('üîù Closing quiz and scrolling to top');
            // Reset quiz
            document.getElementById('quiz-start').classList.remove('hidden');
            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('quiz-results').classList.remove('active');
            document.getElementById('quiz-name-form').reset();
            selectedAnswers = {};
            currentQuestionIndex = 0;
            currentQuiz = [];
            
            // Scroll to top smoothly
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        document.getElementById('quiz-name-form').addEventListener('submit', (e) => { e.preventDefault(); startQuiz(document.getElementById('student-name-input').value); });
        
        // SCROLL REVEAL WITH INTERSECTION OBSERVER
        const revealElements = document.querySelectorAll('.reveal');
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);
        revealElements.forEach(el => observer.observe(el));

        // GROWING PLANTS ANIMATION
        function createGrowingPlants() {
            const container = document.getElementById('plant-container');
            const plants = ['üå±', 'üåø', 'üçÉ', 'üåæ', 'üå≥'];
            
            for (let i = 0; i < 12; i++) {
                const plant = document.createElement('div');
                plant.className = 'plant grow sway';
                plant.textContent = plants[Math.floor(Math.random() * plants.length)];
                plant.style.left = Math.random() * 100 + '%';
                plant.style.top = Math.random() * 100 + '%';
                plant.style.animationDelay = Math.random() * 2 + 's';
                plant.style.animationDuration = (1 + Math.random() * 0.8) + 's';
                container.appendChild(plant);
            }
        }

        createGrowingPlants();
        checkAuth();
    </script>
</body>
</html>